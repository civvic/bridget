<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Programmatic access to notebook cells and outputs.">

<title>Notebook state – bridget</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-000f0825b9c55ed21d14970d810c14a9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Notebook state – bridget">
<meta property="og:description" content="Programmatic access to notebook cells and outputs.">
<meta property="og:site_name" content="bridget">
<meta name="twitter:title" content="Notebook state – bridget">
<meta name="twitter:description" content="Programmatic access to notebook cells and outputs.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">bridget</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./nb.html">Notebook State</a></li><li class="breadcrumb-item"><a href="./nb_state.html">Notebook state</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bridget</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Core Components</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./helpers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Helpers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jstransform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Javascript import transform</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fasthtml_patching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FastHTML patching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./route_provider.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Routes provider</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bridge</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bridge_widget.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bridge widget helpers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logger.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loggers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bridge helpers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bridge_plugins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bridge plugins</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Notebook State</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook objects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nb_hooks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook/IPython hooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nb_state.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Notebook state</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Bridget</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bridget.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bridget</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Components</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./details_json.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DetailsJSON</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">JavaScript &amp; Extensions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./javascript_extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JavaScript &amp; Extensions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Examples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples/quickstart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">quickstart.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./examples/htmx_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HTMX Examples</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">(very) WIP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./widget.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Widget (very WIP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nb_outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TBD</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./output_edit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Editable Outputs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anydoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AnyDoc</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prompt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prompt</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nb_mcp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TBD</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nbdev_rt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">nbdev_rt</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#nbstatefeedback" id="toc-nbstatefeedback" class="nav-link active" data-scroll-target="#nbstatefeedback">NBStateFeedback</a></li>
  <li><a href="#nbstatefetcher" id="toc-nbstatefetcher" class="nav-link" data-scroll-target="#nbstatefetcher">NBStateFetcher</a>
  <ul class="collapse">
  <li><a href="#nbstatefetcher-1" id="toc-nbstatefetcher-1" class="nav-link" data-scroll-target="#nbstatefetcher-1">NBStateFetcher</a></li>
  </ul></li>
  <li><a href="#nbstate" id="toc-nbstate" class="nav-link" data-scroll-target="#nbstate">NBState</a>
  <ul class="collapse">
  <li><a href="#nbstate-1" id="toc-nbstate-1" class="nav-link" data-scroll-target="#nbstate-1">NBState</a></li>
  <li><a href="#stateprovider" id="toc-stateprovider" class="nav-link" data-scroll-target="#stateprovider">StateProvider</a></li>
  </ul></li>
  <li><a href="#cell-id" id="toc-cell-id" class="nav-link" data-scroll-target="#cell-id">Cell id</a></li>
  <li><a href="#this" id="toc-this" class="nav-link" data-scroll-target="#this">this</a>
  <ul class="collapse">
  <li><a href="#this-1" id="toc-this-1" class="nav-link" data-scroll-target="#this-1">this</a></li>
  </ul></li>
  <li><a href="#get_nb" id="toc-get_nb" class="nav-link" data-scroll-target="#get_nb">get_nb</a>
  <ul class="collapse">
  <li><a href="#get_nb-1" id="toc-get_nb-1" class="nav-link" data-scroll-target="#get_nb-1">get_nb</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/civvic/bridget/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="nb_state.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./nb.html">Notebook State</a></li><li class="breadcrumb-item"><a href="./nb_state.html">Notebook state</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Notebook state</h1>
</div>

<div>
  <div class="description">
    Programmatic access to notebook cells and outputs.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<!-- # Prologue -->
<hr>
<div id="cell-4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>bridge_cfg.auto_show <span class="op">=</span> <span class="va">True</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>bridge_cfg.auto_id <span class="op">=</span> <span class="va">False</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bridge <span class="op">=</span> get_bridge(show_logger<span class="op">=</span><span class="va">True</span>, wait<span class="op">=</span><span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="brd-logger_1-1764771587" class="brd-logger" style="width: 100%; max-height: 200px;"></div>
</div>
</div>
<section id="nbstatefeedback" class="level1">
<h1>NBStateFeedback</h1>
<blockquote class="blockquote">
<p>Simple visual feedback of notebook state. We manage the notebook state In the front-end and use this helper to show a little feedback of state changes.</p>
</blockquote>
<p>If yuou’re reading this in VSCode-ish environment, ensure the extension developed in <a href="../packages/nbinspect-vscode/README.md">nbinspect-vscode</a> is enabled.</p>
<p>If you want to know how the notebook’s state gets here in real-time, take a look at the <a href="../packages">packages</a> folder.</p>
<div id="cell-7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NBStateFeedback.show(feedback=False, hide=True,debug=False)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>NBStateFeedback.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">

</div>
</div>
<p>Note that the state data <strong>is</strong> still in the <strong>front-end</strong> (JS-land). This function is just a visual feedback of state changes, but we haven’t transferred yet the state to the <strong>kernel</strong> (python-land). We need to have something (the bridge) in the front-end that can transfer the state to the kernel. For that, see next sections.</p>
<p><strong>VSCode weirdness (again)</strong>: Bridget uses an extension to capture notebook state. In Jupyter environments, the extension is triggered when a notebook is opened, monitors state changes, and sends notifications to the frontend, waiting for a widget to retrieve them. Check the JavaScript console to see the extension’s traces.</p>
<p>In VSCode, the extension is also activated when a notebook is opened. However, the front end of the extension—Renderer in VSCode Notebook Extension API parlance—is isolated within a webview, an iframe-like object that the extension can only communicate with via the a very limited messaging API. Renderers are the only means by which extensions can communicate with the JavaScript running in the webview. And renderers can only be triggered by a cell displaying specific MIME types at least once. Therefore, since VSCode only renders its output when a visible cell is executed, the extension’s renderer can only obtain the notebook state relayed by the main extension when the cell is run interactively or is already in the notebook and visible. Fortunately, this only needs to happen once; you can delete the cell or its output, and the extension will continue to work. VSCode’s foibles.</p>
<p>Keep this in mind when running commands like <code>Execute Above Cells</code> or <code>Execute All Cells</code> or similar. If the above cell is already displaying its output, that’s fine; if not, the extension renderer won’t be triggered until it appears, the state won’t be passed to the front end, and the rest of the notebook won’t work properly.</p>
<div id="cell-9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">19</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>19</code></pre>
</div>
</div>
<p>After executing above cell, you’ve noticed a pink flash. We’re monitoring state changes in real-time.</p>
<p>Clear the output of the above cell. Open the details and look for cell #19 (if you haven’t added any new cells above it). Check that it doesn’t have any outputs.</p>
<p>Run the cell again and check to see that it now has outputs.</p>
<p>Create a new cell below this, source or markdown, and write something. Notice that we’re updating the state of cell inputs not just outputs.</p>
<div id="cell-11" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>NBStateFeedback.update(feedback<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>With feedback disabled, the details disclosure in not shown.</p>
<div id="cell-13" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>NBStateFeedback.update(feedback<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-14" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>NBStateFeedback.update(debug<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><a href="https://civvic.github.io/bridget/bridge.html#debug"><code>debug</code></a> affects javascript dev console logging.</p>
<div id="cell-16" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">29</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>29</code></pre>
</div>
</div>
<div id="cell-17" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>NBStateFeedback.update(debug<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-18" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>NBStateFeedback.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/x-notebook-state+json</code></pre>
</div>
</div>
<div id="cell-19" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>NBStateFeedback.hide()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Though we’ve hided the feedback output, Bridget is still monitoring and capturing state changes, as you can see in the dev console. In fact, once activated by showing the feedback output, it’s not possible to deactivate it.</p>
</section>
<section id="nbstatefetcher" class="level1">
<h1>NBStateFetcher</h1>
<blockquote class="blockquote">
<p>A bridge plugin to retrieve notebook state from the front-end to <code>bridge.state</code>.</p>
</blockquote>
<p>Simple plugin to grab the notebook state from the front-end and return it to Python where we really want and need it. And where it should have always been, imho. How much unnecessary pain has the MVC pattern done!</p>
<div id="cell-22" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>bundled(nbstate_js)()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
<p><a href="https://github.com/civvic/bridget/blob/main/bridget/nb_state.py#L78" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="nbstatefetcher-1" class="level3">
<h3 class="anchored" data-anchor-id="nbstatefetcher-1">NBStateFetcher</h3>
<blockquote class="blockquote">
<pre><code> NBStateFetcher ()</code></pre>
</blockquote>
<p><em>Bridge plugin that retrieves notebook state from the front-end</em></p>
<div id="cell-24" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>bridge.logger.show(clear<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="brd-logger_2-1764771587" class="brd-logger" style="width: 100%; max-height: 200px;"></div>
</div>
</div>
<div id="cell-25" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bridge.add_plugins(fetcher <span class="op">:=</span> NBStateFetcher(), wait<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>test_is(<span class="st">'fetcher'</span> <span class="kw">in</span> bridge.plugins, <span class="va">True</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>test_is(<span class="bu">len</span>(bridge.state.cells) <span class="kw">in</span> (<span class="dv">0</span>, l), <span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>WARNING: the extension debounces state notifications to avoid excesive throughput. When running <code>Execute Above Cells</code> or <code>Execute All Cells</code> or similar commands, the extension will group state notifications and the cell below will probably fail. If that’s the case, simply run the cell again.</p>
<div id="cell-27" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cell 39</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(bridge.state.cells), l)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>uri <span class="op">=</span> urllib.parse.urlparse(bridge.state.nbData[<span class="st">'notebookUri'</span>])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> in_vscode_notebook(): test_eq(uri.path, __vsc_ipynb_file__)  <span class="co"># type: ignore</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>bridge.state[<span class="dv">39</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #24837b; } details .string::before { content: "'"; } details .string::after { content: "'"; } details .number { color: #ad8301; } details .true { color: blue; } details .false { color: red; } details .null { color: gray; } span.n { color: darkgrey; } </style>
<details open=""><summary>NBCell@39
</summary>  <ul>
    <li>
<span><span class="n">idx</span>: <span class="v number">39</span></span>    </li>
    <li>
<span><span class="n">cell_type</span>: <span class="v string">markdown</span></span>    </li>
    <li>
<span><span class="n">source</span>: <span class="v string">WARNING: the extension debounces state notifications to avoid excesive throughput. When running `Execute Above Cells` or `Execute All Cells`…</span></span>    </li>
    <li>
<span><span class="n">id</span>: <span class="v string">X54sZmlsZQ==</span></span>    </li>
    <li>
<span><span class="n">metadata</span>: <span class="v ">{'brd': {'id': '5d660c84-66e2-41ab-b3c5-c2e67f16fc7d'}}</span></span>    </li>
  </ul>
</details>
</div>
</div>
<p>Note after running previous cell, the state has not yet been updated. Check that it has no outputs or the outputs are old. We’ll see how to access the state of the current cell below.</p>
<div id="cell-29" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cell 41</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>bridge.state.cells[<span class="dv">39</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #24837b; } details .string::before { content: "'"; } details .string::after { content: "'"; } details .number { color: #ad8301; } details .true { color: blue; } details .false { color: red; } details .null { color: gray; } span.n { color: darkgrey; } </style>
<details open=""><summary>NBCell@39
</summary>  <ul>
    <li>
<span><span class="n">idx</span>: <span class="v number">39</span></span>    </li>
    <li>
<span><span class="n">cell_type</span>: <span class="v string">markdown</span></span>    </li>
    <li>
<span><span class="n">source</span>: <span class="v string">WARNING: the extension debounces state notifications to avoid excesive throughput. When running `Execute Above Cells` or `Execute All Cells`…</span></span>    </li>
    <li>
<span><span class="n">id</span>: <span class="v string">X54sZmlsZQ==</span></span>    </li>
    <li>
<span><span class="n">metadata</span>: <span class="v ">{'brd': {'id': '5d660c84-66e2-41ab-b3c5-c2e67f16fc7d'}}</span></span>    </li>
  </ul>
</details>
</div>
</div>
<div id="cell-30" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>bridge.logger.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="brd-logger_3-1764771587" class="brd-logger" style="width: 100%; max-height: 200px;"></div>
</div>
</div>
<div id="cell-31" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'test5'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>test5</code></pre>
</div>
</div>
<div id="cell-32" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>display(HTML(<span class="st">'&lt;div&gt;test6&lt;/div&gt;'</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>test6</div>
</div>
</div>
</section>
</section>
<section id="nbstate" class="level1">
<h1>NBState</h1>
<blockquote class="blockquote">
<p>Simple wrapper around <a href="https://civvic.github.io/bridget/nb.html#nb"><code>NB</code></a> + <a href="https://civvic.github.io/bridget/nb_state.html#nbstatefetcher"><code>NBStateFetcher</code></a> &amp; <code>NBHooks</code> bridge plugins</p>
</blockquote>
<hr>
<p><a href="https://github.com/civvic/bridget/blob/main/bridget/nb_state.py#L144" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="nbstate-1" class="level3">
<h3 class="anchored" data-anchor-id="nbstate-1">NBState</h3>
<blockquote class="blockquote">
<pre><code> NBState (source:Union[__main__.StateProvider,Mapping,NoneType]=None,
          *bridge_args, plugins=None, **bridge_kw)</code></pre>
</blockquote>
<p><em>Inherit from this to have all attr accesses in <code>self._xtra</code> passed down to <code>self.default</code></em></p>
<hr>
<p><a href="https://github.com/civvic/bridget/blob/main/bridget/nb_state.py#L139" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="stateprovider" class="level3">
<h3 class="anchored" data-anchor-id="stateprovider">StateProvider</h3>
<blockquote class="blockquote">
<pre><code> StateProvider (*args, **kwargs)</code></pre>
</blockquote>
<p>*Base class for protocol classes.</p>
<p>Protocol classes are defined as::</p>
<pre><code>class Proto(Protocol):
    def meth(self) -&gt; int:
        ...</code></pre>
<p>Such classes are primarily used with static type checkers that recognize structural subtyping (static duck-typing).</p>
<p>For example::</p>
<pre><code>class C:
    def meth(self) -&gt; int:
        return 0

def func(x: Proto) -&gt; int:
    return x.meth()

func(C())  # Passes static type check</code></pre>
<p>See PEP 544 for details. Protocol classes decorated with <span class="citation" data-cites="typing.runtime_checkable">@typing.runtime_checkable</span> act as simple-minded runtime protocols that check only the presence of given attributes, ignoring their type signatures. Protocol classes can be generic, they are defined as::</p>
<pre><code>class GenProto[T](Protocol):
    def meth(self) -&gt; T:
        ...*</code></pre>
<div id="cell-36" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> json.loads(Path(<span class="st">'../packages/nbinspect-vscode/test/outputs.json'</span>).read_text(<span class="st">'utf-8'</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>nb <span class="op">=</span> NBState(state)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-37" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>display(nb.mds)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>nb.codes</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(#2) [0,23]</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(#40) [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20...]</code></pre>
</div>
</div>
<div id="cell-38" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>nb <span class="op">=</span> NBState(show_logger<span class="op">=</span><span class="va">True</span>, wait<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>test_eq(nb.source, get_bridge())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="brd-logger_4-1764771587" class="brd-logger" style="width: 100%; max-height: 200px;"></div>
</div>
</div>
<div id="cell-39" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(nb.cells): display(nb[<span class="dv">50</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #24837b; } details .string::before { content: "'"; } details .string::after { content: "'"; } details .number { color: #ad8301; } details .true { color: blue; } details .false { color: red; } details .null { color: gray; } span.n { color: darkgrey; } </style>
<details open=""><summary>NBCell@50
</summary>  <ul>
    <li>
<span><span class="n">idx</span>: <span class="v number">50</span></span>    </li>
    <li>
<span><span class="n">cell_type</span>: <span class="v string">code</span></span>    </li>
    <li>
<span><span class="n">source</span>: <span class="v string">nb = NBState(show_logger=True, wait=5)
test_eq(nb.source, get_bridge())</span></span>    </li>
    <li>
<span><span class="n">id</span>: <span class="v string">Y101sZmlsZQ==</span></span>    </li>
    <li>
<span><span class="n">metadata</span>: <span class="v ">{'brd': {'id': '14138586-2875-4e27-9c03-200e102a591d'}}</span></span>    </li>
<details open=""><summary>outputs
</summary>      <ul>
<details open=""><summary>0
</summary>          <ul>
            <li>
<span><span class="n">output_type</span>: <span class="v string">display_data</span></span>            </li>
<details open=""><summary>data
</summary>              <ul>
                <li>
<span><span class="n">text/html</span>: <span class="v string">&lt;div id='brd-logger_4-1764771587' class='brd-logger' style='width: 100%; max-height: 200px;'&gt;&lt;/div&gt;</span></span>                </li>
                <li>
<span><span class="n">text/plain</span>: <span class="v string">&lt;bridget.helpers.HTML object&gt;</span></span>                </li>
              </ul>
</details>            <li>
<span><span class="n">metadata</span>: <span class="v ">{'transient': {}}</span></span>            </li>
          </ul>
</details>      </ul>
</details>    <li>
<span><span class="n">execution_count</span>: <span class="v number">40</span></span>    </li>
  </ul>
</details>
</div>
</div>
<div id="cell-40" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(shortens(nb[<span class="dv">40</span>:<span class="dv">50</span>], <span class="st">'r'</span>, <span class="dv">80</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>['{\'idx\': 40, \'cell_type\': \'code\', \'source\': "# cell 39\\ntest_eq(len(bridge.state.…',
 '{\'idx\': 41, \'cell_type\': \'markdown\', \'source\': "Note after running previous cell…',
 "{'idx': 42, 'cell_type': 'code', 'source': '# cell 41\\nbridge.state.cells[39]', …",
 "{'idx': 43, 'cell_type': 'code', 'source': 'bridge.logger.show()', 'id': 'X61sZm…",
 '{\'idx\': 44, \'cell_type\': \'code\', \'source\': "print(\'test5\')", \'id\': \'X62sZmlsZQ==…',
 '{\'idx\': 45, \'cell_type\': \'code\', \'source\': "display(HTML(\'&lt;div&gt;test6&lt;/div&gt;\'))", …',
 "{'idx': 46, 'cell_type': 'markdown', 'source': '# NBState\\n&gt; Simple wrapper arou…",
 '{\'idx\': 47, \'cell_type\': \'code\', \'source\': "#| export\\n\\n@runtime_checkable\\ncla…',
 '{\'idx\': 48, \'cell_type\': \'code\', \'source\': "state = json.loads(Path(\'../packages…',
 "{'idx': 49, 'cell_type': 'code', 'source': 'display(nb.mds)\\nnb.codes', 'id': 'Y…"]</code></pre>
</div>
</div>
<div id="cell-41" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(shortens(nb.find(<span class="st">'class'</span>).attrgot(<span class="st">'source'</span>), <span class="st">'r'</span>, <span class="dv">80</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>["#| export\n\nNBSTATE_MIME = 'application/x-notebook-state+json'\n\nclass _NBStateFee…",
 '#| export\n\nclass NBStateFetcher(BridgePlugin):\n    "Bridge plugin that retrieves…',
 '#| export\n\n@runtime_checkable\nclass StateProvider(Protocol):\n    @property\n    d…',
 "list(shortens(nb.find('class').attrgot('source'), 'r', 80))"]</code></pre>
</div>
</div>
<div id="cell-42" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find_me</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-43" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this cell2</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># nb.update()</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>nb.find(<span class="st">'# this cell2'</span>).attrgot(<span class="st">'source'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>(#1) ["# this cell2\n# nb.update()\nnb.find('# this cell2').attrgot('source')"]</code></pre>
</div>
</div>
</section>
</section>
<section id="cell-id" class="level1">
<h1>Cell id</h1>
<p>For this to work, bridge must be loaded with the <a href="https://civvic.github.io/bridget/bridge_plugins.html#nbhooksplugin"><code>NBHooksPlugin</code></a> (NBState takes care of all that) .</p>
<div id="cell-45" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># really hate stupid wiggly reds</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>__cellinfo__:AD</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-46" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>__cellinfo__<span class="sc">.</span>cell_id<span class="sc">!r}</span><span class="ch">\n</span><span class="sc">{</span>__cellinfo__<span class="sc">.</span>source<span class="sc">!r}</span><span class="ss">"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>test_eq(__cellinfo__.source[:<span class="dv">29</span>], <span class="st">'print(f"{__cellinfo__.cell_id'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'Y114sZmlsZQ=='
'print(f"{__cellinfo__.cell_id!r}\\n{__cellinfo__.source!r}")\ntest_eq(__cellinfo__.source[:29], \'print(f"{__cellinfo__.cell_id\')'</code></pre>
</div>
</div>
<div id="cell-47" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cell x</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> nb.find(<span class="st">'# cell x'</span>)[<span class="dv">0</span>].idx  <span class="co"># type: ignore</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>test_eq(__cellinfo__.cell_id, nb[idx].<span class="bu">id</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>nb[idx]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #24837b; } details .string::before { content: "'"; } details .string::after { content: "'"; } details .number { color: #ad8301; } details .true { color: blue; } details .false { color: red; } details .null { color: gray; } span.n { color: darkgrey; } </style>
<details open=""><summary>NBCell@61
</summary>  <ul>
    <li>
<span><span class="n">idx</span>: <span class="v number">61</span></span>    </li>
    <li>
<span><span class="n">cell_type</span>: <span class="v string">code</span></span>    </li>
    <li>
<span><span class="n">source</span>: <span class="v string"># cell x
idx = nb.find('# cell x')[0].idx  # type: ignore
test_eq(__cellinfo__.cell_id, nb[idx].id)
nb[idx]</span></span>    </li>
    <li>
<span><span class="n">id</span>: <span class="v string">Y115sZmlsZQ==</span></span>    </li>
    <li>
<span><span class="n">metadata</span>: <span class="v ">{'brd': {'id': 'dbdca1cc-dcde-4bc3-9738-c1e14cd72069'}}</span></span>    </li>
<details open=""><summary>outputs
</summary>      <ul></ul>
</details>    <li>
<span><span class="n">execution_count</span>: <span class="v null">None</span></span>    </li>
  </ul>
</details>
</div>
</div>
</section>
<section id="this" class="level1">
<h1>this</h1>
<p><a href="https://civvic.github.io/bridget/nb_state.html#this"><code>this</code></a> marks the finale of the first part of Bridget.</p>
<p>We now have all the pieces to build the bridge. - fasthtml &amp; other helper scripts - loader of arbitrary JS code - notebook state fetcher - nbstate and nb hooks</p>
<p>Next steps will be to add tools to edit notebook outputs.</p>
<hr>
<p><a href="https://github.com/civvic/bridget/blob/main/bridget/nb_state.py#L179" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="this-1" class="level3">
<h3 class="anchored" data-anchor-id="this-1">this</h3>
<blockquote class="blockquote">
<pre><code> this (idx:int|None=None)</code></pre>
</blockquote>
<p><em>Current cell if <code>idx</code> is None, or cell at <code>idx</code> from current cell upwards. Raises if not found.</em></p>
<div id="cell-50" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>bridge.logger.show(clear<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div id="brd-logger_5-1764771587" class="brd-logger" style="width: 100%; max-height: 200px;"></div>
</div>
</div>
<div id="cell-51" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> this()<span class="op">;</span> c</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #24837b; } details .string::before { content: "'"; } details .string::after { content: "'"; } details .number { color: #ad8301; } details .true { color: blue; } details .false { color: red; } details .null { color: gray; } span.n { color: darkgrey; } </style>
<details open=""><summary>NBCell@66
</summary>  <ul>
    <li>
<span><span class="n">idx</span>: <span class="v number">66</span></span>    </li>
    <li>
<span><span class="n">cell_type</span>: <span class="v string">code</span></span>    </li>
    <li>
<span><span class="n">source</span>: <span class="v string">c = this(); c</span></span>    </li>
    <li>
<span><span class="n">id</span>: <span class="v string">Y123sZmlsZQ==</span></span>    </li>
    <li>
<span><span class="n">metadata</span>: <span class="v ">{'brd': {'id': '73daee75-5371-4c72-9211-52443b4b2bf7'}}</span></span>    </li>
<details open=""><summary>outputs
</summary>      <ul></ul>
</details>    <li>
<span><span class="n">execution_count</span>: <span class="v null">None</span></span>    </li>
  </ul>
</details>
</div>
</div>
<div id="cell-52" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>c</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #24837b; } details .string::before { content: "'"; } details .string::after { content: "'"; } details .number { color: #ad8301; } details .true { color: blue; } details .false { color: red; } details .null { color: gray; } span.n { color: darkgrey; } </style>
<details open=""><summary>NBCell@66
</summary>  <ul>
    <li>
<span><span class="n">idx</span>: <span class="v number">66</span></span>    </li>
    <li>
<span><span class="n">cell_type</span>: <span class="v string">code</span></span>    </li>
    <li>
<span><span class="n">source</span>: <span class="v string">c = this(); c</span></span>    </li>
    <li>
<span><span class="n">id</span>: <span class="v string">Y123sZmlsZQ==</span></span>    </li>
    <li>
<span><span class="n">metadata</span>: <span class="v ">{'brd': {'id': '73daee75-5371-4c72-9211-52443b4b2bf7'}}</span></span>    </li>
<details open=""><summary>outputs
</summary>      <ul>
<details open=""><summary>0
</summary>          <ul>
            <li>
<span><span class="n">output_type</span>: <span class="v string">execute_result</span></span>            </li>
            <li>
<span><span class="n">execution_count</span>: <span class="v number">54</span></span>            </li>
<details open=""><summary>data
</summary>              <ul>
                <li>
<span><span class="n">text/plain</span>: <span class="v string">{'idx': 66,
 'cell_type': 'code',
 'source': 'c = this(); c',
 'id': 'Y123sZmlsZQ==',
 'metadata': {'brd': {'id': '73daee75-5371-4c72-9211-5…</span></span>                </li>
                <li>
<span><span class="n">text/html</span>: <span class="v string">&lt;style&gt;details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #2…</span></span>                </li>
                <li>
<span><span class="n">text/markdown</span>: <span class="v string">&gt; code

```json
{
  'idx': 66,
  'cell_type': 'code',
  'source': 'c = this(); c',
  'id': 'Y123sZmlsZQ==',
  'metadata': {'brd': {'id': '73…</span></span>                </li>
              </ul>
</details>            <li>
<span><span class="n">metadata</span>: <span class="v ">{}</span></span>            </li>
          </ul>
</details>      </ul>
</details>    <li>
<span><span class="n">execution_count</span>: <span class="v number">54</span></span>    </li>
  </ul>
</details>
</div>
</div>
<p><a href="https://civvic.github.io/bridget/nb_state.html#this"><code>this</code></a> is meant to be used interactively (as most of Bridget is).</p>
<p>The main function of <a href="https://civvic.github.io/bridget/nb_state.html#this"><code>this</code></a> is to get the current cell, or more so, the current cell’s index, and get your bearings in the current notebook structure.</p>
<p>Note that due to the client-server nature of the Jupyter notebooks, code running in the kernel can’t possibly access the cell currently being executed. The cell state is maintained byt the front-end, not the kernel. The kernel in fact knows nothing of notebooks or their structure. We can aspire at most to get the cell’s index and source. The output is not yet determined, though Bridget will capture it and you can access it <strong>after</strong> the cell has run, not during the cell execution. You can find the cell with NBState afterwards.</p>
<p>Also be aware, as always, that batch commands like “Execute Above Cells” and similar are implemented very differently by Jupyter Notebooks vendors. The cells in the run queue may start running in order (or not, I’ve seen ships on fire off the shoulder of Orion), but not necessarily finish up in that order. Bridget may receive the cells in any order and therefore, the notebook state is not settled until the end. In general, in Jupyter Notebooks, cells that depends on outputs of other cells will surely fail when not running interactively. This is known issue (and a desing flaw imo, that can be resolved simply by the front-end sending the cells in order to the kernel and waiting for each one to fisnish before sending the next one) and one of the reason Marimo and other Jupyter modern alternatives exists.</p>
<div id="cell-54" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>this(<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<style>details ul { list-style-type:none; list-style-position: outside; padding-inline-start: 22px; margin: 0; } details .string { color: #24837b; } details .string::before { content: "'"; } details .string::after { content: "'"; } details .number { color: #ad8301; } details .true { color: blue; } details .false { color: red; } details .null { color: gray; } span.n { color: darkgrey; } </style>
<details open=""><summary>NBCell@68
</summary>  <ul>
    <li>
<span><span class="n">idx</span>: <span class="v number">68</span></span>    </li>
    <li>
<span><span class="n">cell_type</span>: <span class="v string">markdown</span></span>    </li>
    <li>
<span><span class="n">source</span>: <span class="v string">`this` is meant to be used interactively (as most of Bridget is).

The main function of `this` is to get the current cell, or more so, the c…</span></span>    </li>
    <li>
<span><span class="n">id</span>: <span class="v string">Y125sZmlsZQ==</span></span>    </li>
    <li>
<span><span class="n">metadata</span>: <span class="v ">{'brd': {'id': '93341472-e8c3-44ed-8a54-24e71d861fbc'}}</span></span>    </li>
  </ul>
</details>
</div>
</div>
<div id="cell-55" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>this(<span class="op">-</span><span class="dv">3</span>).source</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'c'</code></pre>
</div>
</div>
<div id="cell-56" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>this(FIRST).source</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'#| default_exp nb_state'</code></pre>
</div>
</div>
<div id="cell-57" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>this(LAST).source</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>"#| hide\n#| eval: false\n\nif FC.IN_NOTEBOOK:\n    BUNDLE_PATH = bundle_path(__name__)\n    for f in ['nbstate']: bundled(BUNDLE_PATH / f'js/{f}.js')()\n    nb_path = '21_nb_state.ipynb'\n    nbdev_clean(nb_path)\n    nbdev.nbdev_export(nb_path)"</code></pre>
</div>
</div>
<div id="cell-58" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>this(<span class="dv">1</span>).source</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>'# get_nb'</code></pre>
</div>
</div>
</section>
</section>
<section id="get_nb" class="level1">
<h1>get_nb</h1>
<hr>
<p><a href="https://github.com/civvic/bridget/blob/main/bridget/nb_state.py#L201" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_nb-1" class="level3">
<h3 class="anchored" data-anchor-id="get_nb-1">get_nb</h3>
<blockquote class="blockquote">
<pre><code> get_nb (*args, show_feedback:bool=False, logger:NBLogger|None=None,
         show_logger:bool=False, lnks:dict[str,FT]|None=None,
         esms:dict[str,str|Path]|None=None,
         plugins:Sequence[BridgePlugin]|None=None,
         kwplugins:dict[str,str]|None=None, wait:int=0,
         summary:bool=False, factory:Callable[...,Any]|None=None,
         timeout:float=10, sleep:float=0.2, n:int=10,
         show:Callable[[bool],None]|None=None)</code></pre>
</blockquote>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>args</td>
<td>VAR_POSITIONAL</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>show_feedback</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="odd">
<td>logger</td>
<td>NBLogger | None</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>show_logger</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="odd">
<td>lnks</td>
<td>dict[str, FT] | None</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>esms</td>
<td>dict[str, str | Path] | None</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>plugins</td>
<td>Sequence[BridgePlugin] | None</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>kwplugins</td>
<td>dict[str, str] | None</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>wait</td>
<td>int</td>
<td>0</td>
<td>seconds to wait for plugins/links/modules to load</td>
</tr>
<tr class="even">
<td>summary</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="odd">
<td>factory</td>
<td>Callable[…, Any] | None</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>timeout</td>
<td>float</td>
<td>10</td>
<td></td>
</tr>
<tr class="odd">
<td>sleep</td>
<td>float</td>
<td>0.2</td>
<td></td>
</tr>
<tr class="even">
<td>n</td>
<td>int</td>
<td>10</td>
<td></td>
</tr>
<tr class="odd">
<td>show</td>
<td>Callable[[bool], None] | None</td>
<td>None</td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<!-- # Colophon -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/civvic\.github\.io\/bridget");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/civvic/bridget/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>